<div class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-900 to-slate-800">
  <%= render Features::HeaderComponent.new(user: current_user, show_logo_link: false) %>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <%# PWA Install Prompt %>
    <div class="mb-6">
      <%= render "shared/pwa_install_prompt" %>
    </div>

    <!-- Stats Overview -->
    <div data-controller="collapse" data-collapse-open-value="true" class="mb-8">
      <button 
        type="button" 
        data-action="click->collapse#toggle" 
        class="flex items-center gap-2 text-slate-400 hover:text-white transition-colors mb-4 group"
      >
        <span class="text-sm font-medium uppercase tracking-wider"><%= t('.stats_overview') %></span>
        <span data-collapse-target="icon" class="transition-transform duration-200">
          <%= render Ui::IconComponent.new(name: :chevron_up, size: :sm) %>
        </span>
      </button>

      <div data-collapse-target="content" class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <%= render Ui::StatCardComponent.new(
          value: @medical_folders.count,
          label: t('.stat_folders'),
          icon: :folder,
          color: "emerald"
        ) %>

        <%= render Ui::StatCardComponent.new(
          value: @total_documents,
          label: t('.stat_documents'),
          icon: :document,
          color: "cyan"
        ) %>

        <%= render Ui::StatCardComponent.new(
          value: @folders_by_specialty.keys.count,
          label: t('.stat_specialties'),
          icon: :archive,
          color: "violet"
        ) %>
      </div>
    </div>

    <!-- Main Content -->
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Folders Section -->
      <div class="flex-1">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-bold text-white"><%= t('.your_folders') %></h2>
          <%= render Ui::ButtonComponent.new(href: new_medical_folder_path, icon: :plus) do %>
            <%= t('.new_folder') %>
          <% end %>
        </div>

        <% if @medical_folders.any? %>
          <div class="grid gap-4">
            <% @medical_folders.each do |folder| %>
              <%= render Features::FolderCardComponent.new(folder: folder) %>
            <% end %>
          </div>
        <% else %>
          <%= render Ui::EmptyStateComponent.new(
            title: t('.no_folders_title'),
            description: t('.no_folders_description'),
            icon: :folder,
            action_text: t('.create_first_folder'),
            action_href: new_medical_folder_path
          ) %>
        <% end %>
      </div>

      <!-- Recent Activity Sidebar -->
      <div class="lg:w-80">
        <h2 class="text-xl font-bold text-white mb-6"><%= t('.recent_documents') %></h2>
        
        <% if @recent_documents.any? %>
          <div class="space-y-3">
            <% @recent_documents.each do |doc| %>
              <%= link_to medical_folder_document_path(doc.medical_folder, doc), class: "block bg-slate-800/30 hover:bg-slate-800/60 border border-slate-700/50 rounded-xl p-4 transition-all" do %>
                <div class="flex items-start gap-3">
                  <div class="w-10 h-10 rounded-lg bg-slate-700/50 flex items-center justify-center flex-shrink-0">
                    <%= render Ui::IconComponent.new(
                      name: doc.file_type == :pdf ? :document_pdf : :image,
                      size: :md,
                      color: doc.file_type == :pdf ? "red-400" : "blue-400"
                    ) %>
                  </div>
                  <div class="min-w-0 flex-1">
                    <p class="text-sm font-medium text-white truncate"><%= doc.title %></p>
                    <p class="text-xs text-slate-500"><%= doc.formatted_date %></p>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        <% else %>
          <%= render Ui::CardComponent.new(variant: :subtle, classes: "p-6 text-center") do %>
            <%= render Ui::IconComponent.new(name: :document, size: :xxl, color: "slate-500", classes: "mx-auto mb-2") %>
            <p class="text-sm text-slate-400"><%= t('.no_documents') %></p>
          <% end %>
        <% end %>
      </div>
    </div>
  </main>
</div>
